"use strict";(self.webpackChunkstacklok=self.webpackChunkstacklok||[]).push([[4362],{3905:(e,t,r)=>{r.d(t,{Zo:()=>c,kt:()=>f});var i=r(67294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,i,n=function(e,t){if(null==e)return{};var r,i,n={},o=Object.keys(e);for(i=0;i<o.length;i++)r=o[i],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)r=o[i],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var l=i.createContext({}),p=function(e){var t=i.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):a(a({},t),e)),r},c=function(e){var t=p(e.components);return i.createElement(l.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},g=i.forwardRef((function(e,t){var r=e.components,n=e.mdxType,o=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=p(r),g=n,f=u["".concat(l,".").concat(g)]||u[g]||d[g]||o;return r?i.createElement(f,a(a({ref:t},c),{},{components:r})):i.createElement(f,a({ref:t},c))}));function f(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=r.length,a=new Array(o);a[0]=g;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[u]="string"==typeof e?e:n,a[1]=s;for(var p=2;p<o;p++)a[p]=r[p];return i.createElement.apply(null,a)}return i.createElement.apply(null,r)}g.displayName="MDXCreateElement"},27880:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>p});var i=r(87462),n=(r(67294),r(3905));const o={title:"Creating your first profile",sidebar_position:40},a="Creating your first profile",s={unversionedId:"getting_started/first_profile",id:"getting_started/first_profile",title:"Creating your first profile",description:"Minder uses profiles to specify common,",source:"@site/docs/getting_started/first_profile.md",sourceDirName:"getting_started",slug:"/getting_started/first_profile",permalink:"/getting_started/first_profile",draft:!1,tags:[],version:"current",sidebarPosition:40,frontMatter:{title:"Creating your first profile",sidebar_position:40},sidebar:"minder",previous:{title:"Register Repositories",permalink:"/getting_started/register_repos"},next:{title:"Automatic Remediations",permalink:"/getting_started/remediations"}},l={},p=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Register repositories",id:"register-repositories",level:2},{value:"Creating and applying profiles",id:"creating-and-applying-profiles",level:2},{value:"Viewing alerts",id:"viewing-alerts",level:2},{value:"Delete registered repositories",id:"delete-registered-repositories",level:2}],c={toc:p},u="wrapper";function d(e){let{components:t,...r}=e;return(0,n.kt)(u,(0,i.Z)({},c,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"creating-your-first-profile"},"Creating your first profile"),(0,n.kt)("p",null,"Minder uses ",(0,n.kt)("a",{parentName:"p",href:"/how-to/create_profile"},"profiles")," to specify common,\nconsistent configuration which should be enforced on all registered\nrepositories.  In this tutorial, you will register a GitHub repository and\ncreate a profile that indicates whether secret scanning is enabled on the\nregistered repositories."),(0,n.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/getting_started/install_cli"},"The ",(0,n.kt)("inlineCode",{parentName:"a"},"minder")," CLI application")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/getting_started/login"},"A Minder account")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/getting_started/login#enrolling-the-github-provider"},"An enrolled GitHub token")," that is either an Owner in the organization or an Admin on the repositories")),(0,n.kt)("h2",{id:"register-repositories"},"Register repositories"),(0,n.kt)("p",null,"Once you have enrolled a provider, you can register repositories from that provider."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"minder repo register --provider github\n")),(0,n.kt)("p",null,"This command will show a list of the public repositories available for\nregistration.  Navigate through the repositories using the arrow keys and\nselect one or more repositories for registration using the space key.  Press\nenter once you have selected all the desired repositories."),(0,n.kt)("p",null,"You can also register a repository (or set of repositories) by name:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},'minder repo register --provider github --repo "owner:repo1,owner:repo2"\n')),(0,n.kt)("p",null,"You can see the list of repositories registered in Minder with the ",(0,n.kt)("inlineCode",{parentName:"p"},"repo list")," command:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"minder repo list --provider github\n")),(0,n.kt)("h2",{id:"creating-and-applying-profiles"},"Creating and applying profiles"),(0,n.kt)("p",null,"A profile is a set of rules that you apply to your registered repositories.\nBefore creating a profile, you need to ensure that all desired rule_types have been created in Minder."),(0,n.kt)("p",null,"Start by creating a rule that checks if secret scanning is enabled and creates\na security advisory alert if secret scanning is not enabled.",(0,n.kt)("br",{parentName:"p"}),"\n","This is a reference rule provided by the Minder team in the ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/stacklok/minder-rules-and-profiles"},"minder-rules-and-profiles repository"),"."),(0,n.kt)("p",null,"For this exercise, we're going to download just the ",(0,n.kt)("inlineCode",{parentName:"p"},"secret_scanning.yaml"),"\nrule, and then use ",(0,n.kt)("inlineCode",{parentName:"p"},"minder rule_type create")," to define the secret scanning rule."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"curl -LO https://raw.githubusercontent.com/stacklok/minder-rules-and-profiles/main/rule-types/github/secret_scanning.yaml\n\nminder rule_type create -f secret_scanning.yaml\n")),(0,n.kt)("p",null,"Next, create a profile that applies the secret scanning rule."),(0,n.kt)("p",null,"Create a new file called ",(0,n.kt)("inlineCode",{parentName:"p"},"profile.yaml"),".\nPaste the following profile definition into the newly created file."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-yaml"},'---\nversion: v1\ntype: profile\nname: github-profile\ncontext:\n  provider: github\nalert: "on"\nremediate: "off"\nrepository:\n  - type: secret_scanning\n    def:\n      enabled: true\n')),(0,n.kt)("p",null,"Create the profile in Minder:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"minder profile create -f profile.yaml\n")),(0,n.kt)("p",null,"Check the status of the profile:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"minder profile_status list --profile github-profile\n")),(0,n.kt)("p",null,"If all registered repositories have secret scanning enabled, you will see the ",(0,n.kt)("inlineCode",{parentName:"p"},"OVERALL STATUS")," is ",(0,n.kt)("inlineCode",{parentName:"p"},"Success"),", otherwise the\noverall status is ",(0,n.kt)("inlineCode",{parentName:"p"},"Failure"),"."),(0,n.kt)("p",null,"See a detailed view of which repositories satisfy the secret scanning rule:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"minder profile_status list --profile github-profile --detailed\n")),(0,n.kt)("h2",{id:"viewing-alerts"},"Viewing alerts"),(0,n.kt)("p",null,"Disable secret scanning in one of the registered repositories, by following\n",(0,n.kt)("a",{parentName:"p",href:"https://docs.github.com/en/code-security/secret-scanning/configuring-secret-scanning-for-your-repositories"},"these instructions provided by GitHub"),"."),(0,n.kt)("p",null,"Navigate to the repository on GitHub, click on the Security tab and view the Security Advisories.",(0,n.kt)("br",{parentName:"p"}),"\n","Notice that there is a new advisory titled ",(0,n.kt)("inlineCode",{parentName:"p"},"minder: profile github-profile failed with rule secret_scanning"),"."),(0,n.kt)("p",null,"Enable secret scanning in the same registered repository, by following\n",(0,n.kt)("a",{parentName:"p",href:"https://docs.github.com/en/code-security/secret-scanning/configuring-secret-scanning-for-your-repositories"},"these instructions provided by GitHub"),"."),(0,n.kt)("p",null,"Navigate to the repository on GitHub, click on the Security tab and view the Security Advisories.\nNotice that the advisory titled ",(0,n.kt)("inlineCode",{parentName:"p"},"minder: profile github-profile failed with rule secret_scanning")," is now closed."),(0,n.kt)("h2",{id:"delete-registered-repositories"},"Delete registered repositories"),(0,n.kt)("p",null,"If you wish to delete a registered repository, you can do so with the following command:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"minder repo delete -n $REPO_NAME --provider github\n")),(0,n.kt)("p",null,"where ",(0,n.kt)("inlineCode",{parentName:"p"},"$REPO_NAME")," is the fully-qualified name (",(0,n.kt)("inlineCode",{parentName:"p"},"owner/name"),") of the repository you wish to delete, for example ",(0,n.kt)("inlineCode",{parentName:"p"},"testorg/testrepo"),"."))}d.isMDXComponent=!0}}]);